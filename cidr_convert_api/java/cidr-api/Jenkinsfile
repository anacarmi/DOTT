pipeline {
	agent any
		stages {
			stage('Build') {
				steps {
					dir("cidr_convert_api/java/") {
						sh 'pwd'
						sh 'chmod +x build.sh'
						// sh "./build.sh" 
					}	
				}
			} 

			stage('Code Analysis') {
				steps {
					script { env.SONAR_TOKEN="d886edbdf658a6c002602fa25dbb04fae9cd9f13" }
					dir("cidr_convert_api/java/cidr-api/") {
					sh 'pwd'
				        sh 'mvn verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar' } 
				}
			}
			
			stage('Testing') {
				steps {
					sh 'echo "este es mi testing"'
					dir("cidr_convert_api/java/cidr-api/") 
						{ sh 'mvn test' }
				}
				post {
					always { junit 'target/surefire-reports/*.xml' }
				}
			}
		}
}
